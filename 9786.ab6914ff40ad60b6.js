"use strict";(self.webpackChunkadminDesign=self.webpackChunkadminDesign||[]).push([[9786],{9786:(dt,v,r)=>{r.r(v),r.d(v,{FeesDiscountModule:()=>ct});var c=r(6895),s=r(4006),d=r(7466),I=r(5593),C=r(2453),b=r(8796),D=r(7392),x=r(4850),N=r(6338),p=r(9549),y=r(8255),M=r(3683),g=r(3848),w=r(3546),q=r(2137),U=r(7729),T=r(5412),O=r(6709),Z=r(4144),f=r(9602),R=r(3238),A=r(4364),m=r(805),S=r(5226),h=r.n(S),t=r(4650),G=r(6991),B=r(5620),F=r(1740);function j(n,a){1&n&&(t.TgZ(0,"mat-icon",37),t._uU(1,"trending_up"),t.qZA(),t._uU(2," Entry "))}function L(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"ng-select",38),t.NdJ("change",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.getTranMasterId())}),t.qZA()}if(2&n){const e=t.oxw();t.Q6J("items",e.courseNameList)}}function k(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"ng-select",39),t.NdJ("change",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.getActiveCourse())}),t.qZA()}if(2&n){const e=t.oxw();t.Q6J("items",e.tranMasterIdArray)}}function P(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"mat-form-field")(1,"mat-label"),t._uU(2,"Enter Amount"),t.qZA(),t.TgZ(3,"input",40),t.NdJ("ngModelChange",function(i){t.CHM(e);const u=t.oxw();return t.KtG(u.discountAmountNgModel=i)}),t.qZA()()}if(2&n){const e=t.oxw();t.xp6(3),t.Q6J("ngModel",e.discountAmountNgModel)}}function J(n,a){if(1&n&&(t.TgZ(0,"tr")(1,"th",52),t._uU(2),t.qZA(),t.TgZ(3,"th",52),t._uU(4),t.qZA(),t.TgZ(5,"th",52),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td",23),t._uU(10),t.ALo(11,"currency"),t.qZA()()),2&n){const e=a.$implicit,o=a.index;t.xp6(2),t.Oqu(o),t.xp6(2),t.Oqu(e.id),t.xp6(2),t.Oqu(e.ledger_id),t.xp6(2),t.Oqu(e.ledger_name),t.xp6(2),t.Oqu(t.xi3(11,5,e.total_billed,"INR"))}}function Y(n,a){if(1&n&&(t.TgZ(0,"div",41)(1,"table",42)(2,"thead")(3,"tr")(4,"th",43),t._uU(5,"index"),t.qZA(),t.TgZ(6,"th",43),t._uU(7,"Tr id"),t.qZA(),t.TgZ(8,"th",43),t._uU(9,"Ledger id"),t.qZA(),t.TgZ(10,"th",44),t._uU(11,"Fees Name"),t.qZA(),t.TgZ(12,"th",45),t._uU(13,"Total Billed"),t.qZA()()(),t.TgZ(14,"tbody"),t.YNc(15,J,12,8,"tr",46),t.TgZ(16,"tr",47)(17,"th",48),t._uU(18,"Total Due"),t.qZA(),t.TgZ(19,"th",49),t._uU(20),t.ALo(21,"currency"),t.qZA()(),t.TgZ(22,"tr",47)(23,"th",48),t._uU(24,"Total Received"),t.qZA(),t.TgZ(25,"th",49),t._uU(26),t.ALo(27,"currency"),t.qZA()(),t.TgZ(28,"tr",50)(29,"th",48),t._uU(30,"Total Discount"),t.qZA(),t.TgZ(31,"th",49),t._uU(32),t.ALo(33,"currency"),t.qZA()(),t.TgZ(34,"tr",51)(35,"th",48),t._uU(36,"Net Due:"),t.qZA(),t.TgZ(37,"th",49),t._uU(38),t.ALo(39,"currency"),t.qZA()()()()()),2&n){const e=t.oxw();t.xp6(15),t.Q6J("ngForOf",e.feesDueListArray),t.xp6(5),t.hij("",t.xi3(21,5,e.totalBilledAmount,"INR")," "),t.xp6(6),t.hij("",t.xi3(27,8,e.totalReceivedAmount,"INR")," "),t.xp6(6),t.hij("- \xa0 ",t.xi3(33,11,e.totalDiscount,"INR")," "),t.xp6(6),t.hij("",t.xi3(39,14,e.netDueAmount,"INR")," ")}}function Q(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"button",24),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onSave())}),t.TgZ(1,"i",53),t._uU(2," Save "),t.qZA()()}}function V(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"button",54),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onUpdate())}),t.TgZ(1,"i",53),t._uU(2," Update "),t.qZA()()}if(2&n){const e=t.oxw();t.Q6J("disabled",!e.isSave)}}function z(n,a){1&n&&(t.TgZ(0,"mat-icon",37),t._uU(1,"list"),t.qZA(),t._uU(2," View List "))}function E(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"div",55)(1,"button",56),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(),u=t.MAs(46);return t.KtG(i.clear(u))}),t.qZA(),t.TgZ(2,"span",57),t._UZ(3,"i",58),t.TgZ(4,"input",59),t.NdJ("input",function(i){t.CHM(e);const u=t.oxw(),l=t.MAs(46);return t.KtG(l.filterGlobal(u.getEventValue(i),"contains"))}),t.qZA()()()}}function H(n,a){1&n&&(t.TgZ(0,"tr"),t._UZ(1,"th",60),t.TgZ(2,"th"),t._uU(3,"SL"),t.qZA(),t.TgZ(4,"th",61),t._uU(5,"Name "),t._UZ(6,"p-sortIcon",62),t.qZA(),t.TgZ(7,"th"),t._uU(8,"Course"),t.qZA(),t.TgZ(9,"th",63),t._uU(10,"Total Discount "),t._UZ(11,"p-sortIcon",64),t.qZA()())}function K(n,a){if(1&n&&(t.TgZ(0,"tr")(1,"td"),t._UZ(2,"button",65),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.ALo(11,"currency"),t.qZA()()),2&n){const e=a.$implicit,o=a.expanded,i=a.rowIndex;t.xp6(2),t.Q6J("pRowToggler",e)("icon",o?"pi pi-chevron-down":"pi pi-chevron-right"),t.xp6(2),t.Oqu(i+1),t.xp6(2),t.Oqu(e.ledger_name),t.xp6(2),t.Oqu(e.full_name),t.xp6(2),t.Oqu(t.xi3(11,6,e.total_discount,"INR"))}}function X(n,a){if(1&n&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.ALo(3,"date"),t.qZA(),t.TgZ(4,"td"),t._uU(5),t.qZA(),t.TgZ(6,"td"),t._uU(7),t.qZA()()),2&n){const e=a.$implicit;t.xp6(2),t.Oqu(t.xi3(3,3,e.transaction_date,"dd/MM/yyyy")),t.xp6(3),t.Oqu(e.transaction_number),t.xp6(2),t.Oqu(e.ledger_name)}}function $(n,a){if(1&n&&(t.TgZ(0,"tr")(1,"td",66)(2,"div",67)(3,"table",42)(4,"thead")(5,"tr")(6,"th",44),t._uU(7,"Date"),t.qZA(),t.TgZ(8,"th",44),t._uU(9,"Transaction Number"),t.qZA(),t.TgZ(10,"th",44),t._uU(11,"Particulars"),t.qZA()()(),t.TgZ(12,"tbody"),t.YNc(13,X,8,6,"tr",46),t.qZA()()()()()),2&n){const e=a.$implicit;t.xp6(13),t.Q6J("ngForOf",e.fees_discounts)}}function W(n,a){1&n&&(t.TgZ(0,"mat-icon",37),t._uU(1,"thumb_up"),t.qZA(),t._uU(2," Developer Area "))}function tt(n,a){1&n&&(t.TgZ(0,"h2"),t._uU(1,"Fees Transaction Details"),t.qZA())}function et(n,a){if(1&n&&(t.TgZ(0,"tr")(1,"th",72)(2,"h1",73),t._uU(3,"Total Course :\xa0 \xa0"),t.TgZ(4,"b"),t._uU(5),t.ALo(6,"currency"),t.qZA()()(),t.TgZ(7,"th",74)(8,"h1",75),t._uU(9,"Total Due :\xa0 \xa0"),t.TgZ(10,"b"),t._uU(11),t.ALo(12,"currency"),t.qZA()()()(),t.TgZ(13,"tr")(14,"th",44),t._uU(15,"Date"),t.qZA(),t.TgZ(16,"th",44),t._uU(17,"Transaction No"),t.qZA(),t.TgZ(18,"th",44),t._uU(19,"Particulars"),t.qZA(),t.TgZ(20,"th",44),t._uU(21,"Comments"),t.qZA(),t.TgZ(22,"th",44),t._uU(23,"Amount"),t.qZA()()),2&n){const e=t.oxw(2);t.xp6(5),t.Oqu(t.xi3(6,2,e.totalCourseDue,"INR")),t.xp6(6),t.Oqu(t.xi3(12,5,e.totalCurrentDue,"INR"))}}function ot(n,a){if(1&n&&(t.TgZ(0,"tr")(1,"td",76),t._uU(2),t.qZA(),t.TgZ(3,"td",76),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td",77),t._uU(10),t.ALo(11,"currency"),t.qZA()()),2&n){const e=a.$implicit;t.xp6(2),t.Oqu(e.transaction_date),t.xp6(2),t.Oqu(e.transaction_number),t.xp6(2),t.Oqu(e.ledger_name),t.xp6(2),t.Oqu(e.comment),t.xp6(2),t.Oqu(t.xi3(11,5,e.temp_total_received,"INR"))}}function nt(n,a){if(1&n&&(t.TgZ(0,"tr")(1,"th",78),t._uU(2,"Grand Total:"),t.qZA(),t.TgZ(3,"th",77),t._uU(4),t.ALo(5,"currency"),t.qZA()()),2&n){const e=t.oxw(2);t.xp6(4),t.Oqu(t.xi3(5,1,e.receivedGrandTotal,"INR"))}}function st(n,a){if(1&n&&(t.TgZ(0,"div",68)(1,"p-table",69,70),t.YNc(3,tt,2,0,"ng-template",31),t.YNc(4,et,24,8,"ng-template",32),t.YNc(5,ot,12,8,"ng-template",33),t.YNc(6,nt,6,4,"ng-template",71),t.qZA()()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("value",e.feesReceivedDetailsArray)}}const it=function(){return[5,10,25,50]},at=function(){return["ledger_name","full_name","total_discount"]},rt=[{path:"",component:(()=>{class n{constructor(e,o,i,u,l,lt){this.transactionServicesService=e,this.confirmationService=o,this.activatedRoute=i,this.messageService=u,this.commonService=l,this.dialog=lt,this.UserID=0,this.organisationId=0,this.isDeviceXS=!1,this.checked=!1,this.isSave=!1,this.totalCurrentDue=0,this.courseNameBoolean=!1,this.transactionNoBoolean=!1,this.feeAmountBoolean=!1,this.saveButtonBoolean=!1,this.totalFees=0,this.totalCourseDue=0,this.totalBilledAmount=0,this.totalReceivedAmount=0,this.receivedGrandTotal=0,this.totalDiscount=0,this.netDueAmount=0,this.totalDuedAmount=0,this.showTableRow=!1,this.disabled=!1,this.hiddenPopup=!1,this.hiddenInput=!1,this.showBox=!0,this.isShown=!1,this.isPopupButton=!1,this.hiddenPopupDiscount=!1,this.isCashReceived=!1,this.referenceTransactionMasterId=0,this.feesReceivedDetailsArray=[],this.feesDueListArray=[],this.studentNameList=[],this.feesNameList=[],this.courseNameList=[],this.transactionList=[],this.tempFeesArray=[],this.feesDiscountArray=[],this.tranMasterIdArray=[],this.discountTranIDArray=[],this.feesChargeDetailsArray=[],this.tempFeesReceivedArray=[],this.courses=[],this.popUpRestultArray=[],this.getCourseIdArray=[],this.ledgerId=0,this.amount=0,this.event=0,this.tempTotalAmount=0,this.totalAmount=0,this.removeTotalAmount=0,this.discountAmountNgModel=0,this.selectedIndex=0,this.activatedRoute.data.subscribe(ht=>{}),this.isDeviceXS=l.getDeviceXs();const _=localStorage.getItem("user");_&&(this.UserID=JSON.parse(_).uniqueId,this.organisationId=JSON.parse(_).organisationId,console.log("user localUserID:",this.UserID),console.log("user organisationId:",this.organisationId))}ngOnInit(){const e=new Date;let o=(0,c.p6)(e,"yyyy-MM-dd","en");this.FeesDiscountFormGroup=new s.cw({pay_discount:new s.NI(0,[s.kI.required]),studentId:new s.NI(1,[s.kI.required]),transactionId:new s.NI(0,[s.kI.required]),transactionMasterId:new s.NI(1,[s.kI.required]),comment:new s.NI,amount:new s.NI(null,[s.kI.required]),transactionDate:new s.NI(o),studentToCourseId:new s.NI(1,[s.kI.required]),ledgerId:new s.NI(22,[s.kI.required])}),this.BankReceivedFormGroup=new s.cw({accountNo:new s.NI(null,[s.kI.required]),ifscNo:new s.NI(null,[s.kI.required]),branch:new s.NI(null,[s.kI.required])}),this.transactionServicesService.fetchDiscountFeesName().subscribe(i=>{this.feesNameList=i.data}),this.transactionServicesService.fetchAllStudentName(this.organisationId).subscribe(i=>{this.studentNameList=i.data}),this.getAllDiscountFees(this.organisationId)}onTabChanged(e){this.event=e,console.log(this.event)}onClickedOutside(e){this.showBox=!1===this.showBox&&!this.showBox}onClickedRowShow(e){this.totalFees=0,this.studentName=e.studentName,this.courseName=e.courseName,this.transactionServicesService.fetchFeesChargeDetailsById(e.studentCourseRegistrationId).subscribe(o=>{this.feesChargeDetailsArray=o.data;for(let i of this.feesChargeDetailsArray)this.totalFees+=i.amount}),this.showTableRow=!1===this.showTableRow&&!this.showTableRow}getAllDiscountFees(e){this.transactionServicesService.fetchAllFeesDiscount(e).subscribe(o=>{this.feesDiscountArray=o.data,console.log(this.feesDiscountArray)})}getTranMasterId(){this.hiddenPopup=!0,this.receivedGrandTotal=0,this.totalCourseDue=0,this.totalCurrentDue=0,this.tempGetActiveCourseObj={},this.feesReceivedDetailsArray=[],this.tranMasterIdArray=[],this.transactionNoBoolean=!0,this.feeAmountBoolean=!1,this.FeesDiscountFormGroup.patchValue({transactionMasterId:""}),this.FeesDiscountFormGroup.patchValue({amount:""});let e=this.FeesDiscountFormGroup.get("studentToCourseId")?.value;console.log("studentToCourseId:",e),this.tempGetActiveCourseObj={id:e,organisationId:this.organisationId},this.tranMasterIdArray=[],this.transactionServicesService.fetchAllTranMasterId(this.tempGetActiveCourseObj).subscribe(o=>{this.tranMasterIdArray=o.data,console.log(this.tranMasterIdArray)}),console.log("studentToCourseId-2:",e),this.transactionServicesService.fetchFeeReceivedDetailsList(this.tempGetActiveCourseObj).subscribe(o=>{if(this.feesReceivedDetailsArray=o.data,console.log("feesReceivedDetailsArray:",this.feesReceivedDetailsArray),this.feesReceivedDetailsArray[0].totalDue>0){this.totalCourseDue=this.feesReceivedDetailsArray[0].totalDue;for(let i of this.feesReceivedDetailsArray)this.receivedGrandTotal=this.receivedGrandTotal+i.temp_total_received;this.totalCurrentDue=this.totalCourseDue-this.receivedGrandTotal}else this.totalCourseDue=0})}getAllTranMasterId(e){this.FeesDiscountFormGroup.get("studentToCourseId"),this.courseNameList=[],this.tempGetActiveCourseObj={},this.tempGetActiveCourseObj={id:e,organisationId:this.organisationId},this.transactionServicesService.fetchAllTranMasterId(this.tempGetActiveCourseObj).subscribe(i=>{this.tranMasterIdArray=i.data,console.log(this.tranMasterIdArray)})}onAddFees(){this.studentId=this.FeesDiscountFormGroup.get("studentId")?.value,this.studentToCourseId=this.FeesDiscountFormGroup.get("studentToCourseId")?.value,console.log("studentId:",this.studentId),this.ledgerId=this.FeesDiscountFormGroup.get("ledgerId")?.value,this.amount=this.FeesDiscountFormGroup.get("amount")?.value,this.totalAmount=Number(this.totalAmount)+Number(this.amount);const e=this.FeesDiscountFormGroup.value;let o=this.feesNameList.findIndex(i=>i.id===e.ledgerId);this.tempItemObj={ledgerId:this.ledgerId,transactionTypeId:1,feesName:this.feesNameList[o].ledger_name,amount:this.amount},this.tempFeesArray.push(this.tempItemObj),this.tempTotalAmount=this.totalAmount,this.isSave=!0,this.FeesDiscountFormGroup=new s.cw({amount:new s.NI(null,[s.kI.required]),ledgerId:new s.NI(null,[s.kI.required])})}onDelete(e){this.totalAmount=this.totalAmount-this.tempFeesArray[e].amount,this.tempTotalAmount=this.totalAmount,this.tempFeesArray.splice(e,1)}clearFeesDiscount(){this.discountAmountNgModel=0,this.tempGetActiveCourseObj={},this.saveButtonBoolean=!1,this.courseNameBoolean=!1,this.transactionNoBoolean=!1,this.feeAmountBoolean=!1,this.isShown=!1,this.hiddenPopup=!1,this.hiddenPopupDiscount=!1,this.FeesDiscountFormGroup.reset();const e=new Date;let o=(0,c.p6)(e,"yyyy-MM-dd","en");this.FeesDiscountFormGroup=new s.cw({pay_discount:new s.NI(0,[s.kI.required]),studentId:new s.NI(1,[s.kI.required]),transactionId:new s.NI(0,[s.kI.required]),transactionMasterId:new s.NI(1,[s.kI.required]),comment:new s.NI,amount:new s.NI(null,[s.kI.required]),transactionDate:new s.NI(o),studentToCourseId:new s.NI(1,[s.kI.required]),ledgerId:new s.NI(22,[s.kI.required])}),this.totalAmount=0}changeCourseId(){this.courseNameBoolean=!0;let e=this.FeesDiscountFormGroup.get("studentId")?.value;this.courseNameList=[],this.tempGetActiveCourseObj={},this.tranMasterIdArray=[],this.transactionNoBoolean=!1,this.feeAmountBoolean=!1,this.FeesDiscountFormGroup.patchValue({studentToCourseId:""}),this.FeesDiscountFormGroup.patchValue({transactionMasterId:""}),this.FeesDiscountFormGroup.patchValue({amount:""}),this.tempGetActiveCourseObj={ledger_id:e,organisationId:this.organisationId},this.transactionServicesService.fetchAllStudentToCourses(this.tempGetActiveCourseObj).subscribe(o=>{this.courseNameList=o.data})}clear(e){e.clear()}getEventValue(e){return e.target.value}editFeesReceived(e){this.selectedIndex=0,this.hiddenPopup=!1,this.event=0,this.onTabChanged(this.event),this.isShown=!0,this.tempFeesArray=[],this.totalAmount=0,this.transactionServicesService.fetchAllTransaction(e.id).subscribe(o=>{this.transactionList=o.data,this.transactionServicesService.fetchAllStudentToCourses(o.data[0].student_id).subscribe(u=>{this.courseNameList=u.data}),this.FeesDiscountFormGroup.patchValue({transactionId:o.data[0].id}),this.FeesDiscountFormGroup.patchValue({studentId:o.data[0].student_id}),this.FeesDiscountFormGroup.patchValue({studentToCourseId:o.data[0].student_course_registration_id}),this.FeesDiscountFormGroup.patchValue({comment:o.data[0].comment}),this.FeesDiscountFormGroup.patchValue({transactionDate:o.data[0].transaction_date}),this.studentId=o.data[0].student_id,this.studentToCourseId=o.data[0].student_course_registration_id,this.transactionId=o.data[0].id,this.transactionDate=(0,c.p6)(o.data[0].transaction_date,"yyyy-MM-dd","en"),this.comment=o.data[0].comment;for(let u of this.transactionList)this.tempItemObj={ledgerId:u.ledger_id,transactionTypeId:2,feesName:u.ledger_name,amount:u.amount},this.tempFeesArray.push(this.tempItemObj),this.totalAmount=Number(this.totalAmount)+Number(u.amount)})}onUpdate(){this.hiddenPopup=!1,this.confirmationService.confirm({message:"Do you want to Save this record?",header:"Delete Confirmation",icon:"pi pi-info-circle",accept:()=>{this.comment="Discount Allowed";let e=(new Date).getFullYear(),o=(new Date).getMonth().toString();this.tempChargeObj={ledgerId:this.studentId,transactionTypeId:1,amount:this.totalAmount},this.tempFeesArray.push(this.tempChargeObj),this.tempObj={transactionMaster:{userId:1,studentCourseRegistrationId:this.studentToCourseId,transactionDate:this.transactionDate,comment:this.comment,feesYear:e,feesMonth:o},transactionDetails:Object.values(this.tempFeesArray)},this.transactionServicesService.updateFeesCharge(this.transactionId,this.tempObj).subscribe(i=>{1===i.success&&(this.getAllDiscountFees(this.organisationId),this.tempFeesArray=[],this.totalAmount=0,this.clearFeesDiscount(),this.showSuccess("Record Updated successfully"))},i=>{this.showErrorMessage=!0,this.errorMessage=i.message,setTimeout(()=>{this.showErrorMessage=!1},2e4)})},reject:()=>{this.msgs=[{severity:"info",summary:"Rejected",detail:"You have rejected"}]}})}getActiveCourse(){this.feeAmountBoolean=!0,this.hiddenPopupDiscount=!0,this.totalFees=0,this.totalBilledAmount=0,this.totalReceivedAmount=0,this.totalDuedAmount=0,this.totalDiscount=0,this.netDueAmount=0,this.discountAmountNgModel=0;let e=this.FeesDiscountFormGroup.get("transactionMasterId")?.value;console.log("transactionMasterId:",e),this.tempGetActiveCourseObj={},this.tempGetActiveCourseObj={id:e,organisationId:this.organisationId},this.transactionServicesService.fetchFeesDueListId(this.tempGetActiveCourseObj).subscribe(o=>{this.feesDueListArray=o.data,console.log("fees Due list:",this.feesDueListArray),this.totalReceivedAmount=this.feesDueListArray[0].total_received,console.log("totalReceivedAmount:",this.totalReceivedAmount),this.netDueAmount=this.feesDueListArray[0].total_due,console.log("netDueAmount:",this.netDueAmount);for(let i of this.feesDueListArray)this.totalBilledAmount=this.totalBilledAmount+i.total_billed,console.log("total_billed:",i.total_billed);this.tempGetActiveCourseObj={},this.tempGetActiveCourseObj={id:e,organisationId:this.organisationId},this.transactionServicesService.fetchDiscountByTranId(this.tempGetActiveCourseObj).subscribe(i=>{this.discountTranIDArray=i.data,this.totalDiscount=this.discountTranIDArray[0].temp_total_discount,console.log("totalDiscount:",this.totalDiscount),this.discountAmountNgModel=this.netDueAmount,this.totalReceivedAmount=this.totalReceivedAmount-this.totalDiscount,console.log("totalReceivedAmount part 1:",this.totalReceivedAmount),console.log("discountTranIDArray:",this.discountTranIDArray)}),this.totalDuedAmount=this.totalBilledAmount-this.totalReceivedAmount,this.netDueAmount=this.totalDuedAmount,this.discountAmountNgModel=this.netDueAmount}),this.totalReceivedAmount=this.totalReceivedAmount-this.totalDiscount}onSave(){let e=this.FeesDiscountFormGroup.get("transactionMasterId")?.value;this.discountAmount=this.FeesDiscountFormGroup.get("amount")?.value,console.log("discountAmount:",this.discountAmount),console.log("TrId:",e),h().fire({title:"Are you sure?",text:"Save This Record...?",icon:"info",showCancelButton:!0,confirmButtonText:"Yes, Save it!",cancelButtonText:"No, keep it"}).then(o=>{if(o.isConfirmed){this.studentId=this.FeesDiscountFormGroup.get("studentId")?.value,this.comment=this.FeesDiscountFormGroup.get("comment")?.value,this.comment||(this.comment="Discount Allowed");let u=this.FeesDiscountFormGroup.get("transactionDate")?.value;this.transactionDate=(0,c.p6)(u,"yyyy-MM-dd","en");var i=new Date(this.transactionDate);this.transactionMonth=i.getMonth()+1,this.transactionYear=i.getFullYear(),this.tempChargeObj={ledgerId:this.studentId,transactionTypeId:2,amount:this.discountAmount},this.tempReceicedObj={ledgerId:11,transactionTypeId:1,amount:this.discountAmount},this.tempFeesReceivedArray.push(this.tempReceicedObj),this.tempFeesReceivedArray.push(this.tempChargeObj),this.tempObj={transactionMaster:{userId:1,referenceTransactionMasterId:e,transactionDate:this.transactionDate,comment:this.comment,feesYear:this.transactionYear,feesMonth:this.transactionMonth,organisationId:this.organisationId},transactionDetails:Object.values(this.tempFeesReceivedArray)},this.transactionServicesService.saveFeesReceive(this.tempObj).subscribe(l=>{1===l.success&&(h().fire({position:"top-end",icon:"success",title:"Fees Discount has been saved",showConfirmButton:!1,timer:1500}),this.FeesDiscountFormGroup.reset(),this.getAllDiscountFees(this.organisationId),this.feesDueListArray=[],this.totalAmount=0,this.clearFeesDiscount())},l=>{h().fire({icon:"error",title:"Oops...",text:l,footer:"<a href>Why do I have this issue?</a>",timer:0})})}else o.dismiss===h().DismissReason.cancel&&h().fire("Cancelled","Your imaginary file is safe :)","error")})}showSuccess(e){throw new Error("Method not implemented.")}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(G.D),t.Y36(m.YP),t.Y36(A.gz),t.Y36(m.ez),t.Y36(B.v),t.Y36(T.uw))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-fees-discount"]],features:[t._Bn([m.YP,m.ez])],decls:62,vars:26,consts:[[1,"container-fluid","page"],[1,"row","d-flex","align-items-center","justify-content-between"],[1,"col-12","header"],[1,"bi","bi-cash"],[1,"row"],[1,"col-7","mt-3","feeleft"],["animationDuration","200ms",3,"selectedIndex","selectedIndexChange"],["mat-tab-label",""],[1,"p-3","flex-fill",2,"background-color","white"],[3,"formGroup"],[1,"col-sm-4"],["matInput","","formControlName","transactionDate",3,"matDatepicker"],["ref",""],["matSuffix","",3,"for"],["transactionDate",""],[1,"col-sm-5"],["bindLabel","studentName","bindValue","studentId","appendTo","body","formControlName","studentId","placeholder","Student Name",1,"custom",3,"items","change"],["bindLabel","full_name","class","custom","bindValue","id","appendTo","body","formControlName","studentToCourseId","placeholder","Course Name",3,"items","change",4,"ngIf"],[1,"col-sm-7"],["bindLabel","transaction_number","class","custom","bindValue","id","appendTo","body","formControlName","transactionMasterId","placeholder","Transaction No",3,"items","change",4,"ngIf"],[1,"col-sm-2"],[4,"ngIf"],["class","container mt-3","style","background-color:white; margin-left: 0px; font-size: medium;",4,"ngIf"],[1,"text-right"],["pButton","",1,"p-button-rounded","p-button-info","p-button-outlined",3,"click"],[1,"bi","bi-clear",2,"font-size","1rem"],["pButton","","class","p-button-rounded p-button-info p-button-outlined",3,"click",4,"ngIf"],["pButton","","class","p-button-rounded p-button-info",3,"disabled","click",4,"ngIf"],[1,"p-3","flex-fill",2,"width","100%"],["dataKey","id","responsiveLayout","scroll","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries","styleClass","p-datatable-striped",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions","globalFilterFields"],["feesDiscount",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion","class","col-12"],[2,"background-color","yellow"],["class","col-5 mt-3 feeright",4,"ngIf"],[1,"example-tab-icon"],["bindLabel","full_name","bindValue","id","appendTo","body","formControlName","studentToCourseId","placeholder","Course Name",1,"custom",3,"items","change"],["bindLabel","transaction_number","bindValue","id","appendTo","body","formControlName","transactionMasterId","placeholder","Transaction No",1,"custom",3,"items","change"],["matInput","","formControlName","amount",3,"ngModel","ngModelChange"],[1,"container","mt-3",2,"background-color","white","margin-left","0px","font-size","medium"],[1,"table","table-striped"],["scope","col",2,"display","none"],["scope","col"],["scope","col",1,"text-right"],[4,"ngFor","ngForOf"],[2,"background-color","gray","color","blanchedalmond"],["colspan","1",2,"color","blanchedalmond"],[1,"text-right",2,"color","blanchedalmond"],[2,"background-color","rgb(165, 159, 159)","color","rgb(43, 42, 42)"],[2,"background-color","rgb(156, 160, 238)","color","rgb(43, 42, 42)"],["scope","row",2,"display","none"],[1,"bi","bi-save",2,"font-size","1rem"],["pButton","",1,"p-button-rounded","p-button-info",3,"disabled","click"],[1,"flex"],["pButton","","label","Clear","icon","pi pi-filter-slash",1,"p-button-outlined",3,"click"],[1,"p-input-icon-left","ml-auto"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search keyword",3,"input"],[2,"width","3rem"],["pSortableColumn","ledger_name"],["field","ledger_name"],["pSortableColumn","total_discount"],["field","total_discount"],["type","button","pButton","","pRipple","",1,"p-button-text","p-button-rounded","p-button-plain",3,"pRowToggler","icon"],["colspan","7"],[1,"p-3"],[1,"col-5","mt-3","feeright"],[3,"value"],["feesDiscountDetails",""],["pTemplate","footer"],["colspan","3",1,"table-secondary"],[2,"color","red"],["colspan","2",1,"table-secondary"],[2,"color","green"],["scope","row"],["align","right"],["colspan","4"]],template:function(e,o){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._UZ(3,"i",3),t._uU(4,"\xa0 Fees Discount"),t.qZA()(),t.TgZ(5,"div",4)(6,"div",5)(7,"mat-tab-group",6),t.NdJ("selectedIndexChange",function(u){return o.onTabChanged(u)})("selectedIndexChange",function(u){return o.selectedIndex=u}),t.TgZ(8,"mat-tab"),t.YNc(9,j,3,0,"ng-template",7),t.TgZ(10,"div",8)(11,"form",9)(12,"div",4)(13,"div",10)(14,"mat-form-field")(15,"mat-label"),t._uU(16,"Transaction Date"),t.qZA(),t._UZ(17,"input",11,12)(19,"mat-datepicker-toggle",13)(20,"mat-datepicker",null,14),t.qZA()()(),t.TgZ(22,"div",4)(23,"div",15)(24,"ng-select",16),t.NdJ("change",function(){return o.changeCourseId()}),t.qZA()(),t.TgZ(25,"div",15),t.YNc(26,L,1,1,"ng-select",17),t.qZA()(),t.TgZ(27,"div",4)(28,"div",18),t.YNc(29,k,1,1,"ng-select",19),t.qZA(),t.TgZ(30,"div",20),t.YNc(31,P,4,1,"mat-form-field",21),t.qZA()(),t.YNc(32,Y,40,17,"div",22),t.TgZ(33,"p",23)(34,"button",24),t.NdJ("click",function(){return o.clearFeesDiscount()}),t.TgZ(35,"i",25),t._uU(36," Clear "),t.qZA()(),t._uU(37,"\xa0\xa0\xa0 "),t.YNc(38,Q,3,0,"button",26),t.YNc(39,V,3,1,"button",27),t.qZA()()()(),t.TgZ(40,"mat-tab"),t.YNc(41,z,3,0,"ng-template",7),t.TgZ(42,"div",28)(43,"h1"),t._uU(44,"Fees Discount List"),t.qZA(),t.TgZ(45,"p-table",29,30),t.YNc(47,E,5,0,"ng-template",31),t.YNc(48,H,12,0,"ng-template",32),t.YNc(49,K,12,9,"ng-template",33),t.YNc(50,$,14,1,"ng-template",34),t.qZA()()(),t.TgZ(51,"mat-tab"),t.YNc(52,W,3,0,"ng-template",7),t.TgZ(53,"div",35)(54,"pre"),t._uU(55),t.ALo(56,"json"),t.qZA(),t._UZ(57,"hr"),t.TgZ(58,"pre"),t._uU(59),t.ALo(60,"json"),t.qZA()()()()(),t.YNc(61,st,7,1,"div",36),t.qZA()()),2&e){const i=t.MAs(21);t.xp6(7),t.Q6J("selectedIndex",o.selectedIndex),t.xp6(4),t.Q6J("formGroup",o.FeesDiscountFormGroup),t.xp6(6),t.Q6J("matDatepicker",i),t.xp6(2),t.Q6J("for",i),t.xp6(5),t.Q6J("items",o.studentNameList),t.xp6(2),t.Q6J("ngIf",o.courseNameBoolean),t.xp6(3),t.Q6J("ngIf",o.transactionNoBoolean),t.xp6(2),t.Q6J("ngIf",o.feeAmountBoolean),t.xp6(1),t.Q6J("ngIf",o.hiddenPopupDiscount),t.xp6(6),t.Q6J("ngIf",o.netDueAmount>o.discountAmountNgModel&&o.discountAmountNgModel>0||o.discountAmountNgModel>0&&o.netDueAmount===o.discountAmountNgModel||o.saveButtonBoolean),t.xp6(1),t.Q6J("ngIf",o.isShown),t.xp6(6),t.Q6J("value",o.feesDiscountArray)("paginator",!0)("rows",5)("showCurrentPageReport",!0)("rowsPerPageOptions",t.DdM(24,it))("globalFilterFields",t.DdM(25,at)),t.xp6(10),t.hij("              update code = ",t.lcZ(56,20,o.studentNameList),"\n            "),t.xp6(4),t.hij("              save code = ",t.lcZ(60,22,o.tempObj),"\n            "),t.xp6(2),t.Q6J("ngIf",o.hiddenPopup)}},dependencies:[c.sg,c.O5,D.Hw,p.KE,p.hX,p.R9,g.SP,g.uD,g.uX,d.iA,m.jx,d.lQ,d.jB,d.fz,I.Hq,b.w9,Z.Nt,f.Mq,f.hl,f.nW,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,F.o,c.Ts,c.H9,c.uU],styles:[".page[_ngcontent-%COMP%]{color:#0c0c0c;background:whitesmoke}.page__box[_ngcontent-%COMP%]{min-height:100px;background:whitesmoke;margin:0 -3rem;font-size:24px}.page__content[_ngcontent-%COMP%]{min-height:calc(100vh - 160px);border-radius:10px;margin-top:-3rem;background:rgb(159,159,162);border:2px solid black;color:#000;font-size:20px}.page__content-data[_ngcontent-%COMP%]{top:50%;left:50%;transform:translate(-50%,-50%)}  .mat-form-field .mat-input-element{color:#080808;font-size:medium;font-family:Roboto,sans-serif}  .mat-form-field .mat-form-field-label{color:#0a0a0a;font-family:Roboto,sans-serif;font-size:medium}  .mat-form-field .mat-form-field-underline{background-color:#04203b}  .mat-form-field .mat-form-field-ripple{background-color:#708090}  .mat-form-field .mat-form-field-required-marker{color:#be1509}  datepicker-value-example .mat-form-field-label{color:#43b2ee}  .mat-datepicker-toggle{color:#43b2ee}  .mat-form-field-underline{background:#43b2ee}  .mat-tab-group.mat-primary .mat-ink-bar{background-color:#fec61f!important}mat-form-field[_ngcontent-%COMP%]{margin-bottom:-1em}.text-on-pannel[_ngcontent-%COMP%]{background:#fff none repeat scroll 0 0;height:auto;margin-left:20px;padding:3px 5px;position:absolute;margin-top:-47px;border:1px solid #337ab7;border-radius:8px}.panel[_ngcontent-%COMP%]{margin-top:27px!important}.panel-body[_ngcontent-%COMP%]{padding-top:30px!important}.transaction-master-form[_ngcontent-%COMP%]{font-size:large;background-color:#fff;box-shadow:0 10px 6px -6px #777}.transaction-details-form[_ngcontent-%COMP%]{min-height:10vh;min-width:70vh;font-size:medium;box-shadow:0 10px 6px -6px #777}.btn-space[_ngcontent-%COMP%]{margin-right:5px}.header[_ngcontent-%COMP%]{background-color:#383838;padding:.5em 1em;font-size:1.5em;margin:0;color:#fff}.feeleft[_ngcontent-%COMP%]{border-radius:10px;box-shadow:#00000059 0 5px 15px;background-color:#000ba0}.feeright[_ngcontent-%COMP%]{border-radius:10px;box-shadow:#00000059 0 5px 15px}.tableb[_ngcontent-%COMP%]{background-color:#000ba0}@media (max-width: 480px){.feeleft[_ngcontent-%COMP%]{width:100%;background-color:#000ba0}.feeright[_ngcontent-%COMP%]{width:100%}}"]}),n})()}];let ut=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[A.Bz.forChild(rt),A.Bz]}),n})(),ct=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[c.ez,ut,D.Ps,x.t,N.ie,p.lN,y.Tx,M.g0,g.Nh,w.QW,d.U$,I.hJ,C.EV,b.A0,q.D,U.S,Z.c,f.FA,R.XK,T.Is,O.p9,s.UX,F.j]}),n})()}}]);